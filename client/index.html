<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5" />

  <!-- Primary SEO Meta Tags -->
  <title>Free Typing Test | TypeMasterAI - Check Your WPM & Typing Speed Online</title>
  <meta name="title" content="Free Typing Test | TypeMasterAI - Check Your WPM & Typing Speed Online" />
  <meta name="description"
    content="Test your typing speed in 60 seconds! Free online typing test with real-time WPM calculator, accuracy tracker, AI-powered analytics, multiplayer racing, code typing mode for developers, and 23+ languages. No signup required." />
  <meta name="keywords"
    content="typing test, typing speed test, wpm test, words per minute test, free typing test, typing speed, online typing test, typing test wpm, 1 minute typing test, typing accuracy test, typing game, typing practice, monkeytype alternative, code typing test, multiplayer typing race, keyboard test, typing practice online, touch typing, learn to type" />
  <meta name="author" content="TypeMasterAI" />
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow" />
  <link rel="canonical" href="https://typemasterai.com/" />

  <!-- Hreflang Tags for International SEO -->
  <link rel="alternate" hreflang="x-default" href="https://typemasterai.com/" />
  <link rel="alternate" hreflang="es" href="https://typemasterai.com/es/typing-test" />
  <link rel="alternate" hreflang="fr" href="https://typemasterai.com/fr/typing-test" />
  <link rel="alternate" hreflang="de" href="https://typemasterai.com/de/typing-test" />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://typemasterai.com/" />
  <meta property="og:title" content="Free Typing Test | TypeMasterAI - Check Your WPM & Typing Speed Online" />
  <meta property="og:description"
    content="Test your typing speed in 60 seconds! Free online typing test with real-time WPM calculator, accuracy tracker, AI-powered analytics, multiplayer racing, code typing mode for developers, and 23+ languages. No signup required." />
  <meta property="og:image" content="https://typemasterai.com/opengraph.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="TypeMasterAI - Free Online Typing Speed Test with AI Analytics" />
  <meta property="og:site_name" content="TypeMasterAI" />
  <meta property="og:locale" content="en_US" />
  <meta property="fb:app_id" content="" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://typemasterai.com/" />
  <meta name="twitter:title" content="Free Typing Test | TypeMasterAI - Check Your WPM & Typing Speed Online" />
  <meta name="twitter:description"
    content="Test your typing speed in 60 seconds! Free online typing test with real-time WPM calculator, accuracy tracker, and AI-powered analytics. No signup required." />
  <meta name="twitter:image" content="https://typemasterai.com/opengraph.jpg" />
  <meta name="twitter:image:alt" content="TypeMasterAI - Free Online Typing Speed Test" />
  <meta name="twitter:site" content="@TypeMasterAI" />
  <meta name="twitter:creator" content="@TypeMasterAI" />

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#00ffff" media="(prefers-color-scheme: dark)" />
  <meta name="theme-color" content="#f5a623" media="(prefers-color-scheme: light)" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="TypeMasterAI" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="application-name" content="TypeMasterAI" />
  <meta name="msapplication-TileColor" content="#0f172a" />
  <meta name="msapplication-config" content="/browserconfig.xml" />

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json" />

  <!-- Icons - Updated with TypeMasterAI official logo -->
  <link rel="icon" type="image/png" href="/favicon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icon-72x72.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png" />
  <link rel="apple-touch-icon" href="/icon-192x192.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icon-192x192.png" />
  <link rel="apple-touch-icon" sizes="167x167" href="/icon-192x192.png" />
  <link rel="mask-icon" href="/logo-icon.svg" color="#00ffff" />

  <!-- Critical Resource Hints for Core Web Vitals -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />

  <!-- Preload LCP Image for faster render -->
  <link rel="preload" href="/logo-horizontal.svg" as="image" fetchpriority="high" />

  <!-- Importing fonts with font-display: swap for CLS optimization -->
  <link rel="preload"
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
    as="style" fetchpriority="high" />
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
    rel="stylesheet" media="print" onload="this.media='all'" />
  <noscript>
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
      rel="stylesheet" />
  </noscript>

  <!-- Katex CSS for LaTeX math rendering - defer loading -->
  <link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" as="style"
    onload="this.onload=null;this.rel='stylesheet'" />
  <noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"
      integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous" />
  </noscript>

  <!-- Critical CSS for LCP optimization - prevents layout shift -->
  <style>
    /* Critical CSS for above-the-fold content */
    :root {
      --background: 220 15% 10%;
      --foreground: 220 10% 90%;
      --primary: 45 100% 50%;
    }

    html,
    body {
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: hsl(220 15% 10%);
      color: hsl(220 10% 90%);
      min-height: 100vh;
    }

    #root {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Skeleton loader for LCP */
    .skeleton-header {
      height: 64px;
      background: hsl(220 15% 13%);
    }

    .skeleton-hero {
      padding: 2rem;
      text-align: center;
    }

    .skeleton-title {
      height: 48px;
      max-width: 600px;
      margin: 0 auto 1rem;
      background: linear-gradient(90deg, hsl(220 15% 15%) 0%, hsl(220 15% 20%) 50%, hsl(220 15% 15%) 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 8px;
    }

    @keyframes shimmer {
      0% {
        background-position: 200% 0;
      }

      100% {
        background-position: -200% 0;
      }
    }
  </style>


</head>

<body>
  <div id="root">
    <!-- Skeleton loader for better perceived performance while JS loads -->
    <div class="skeleton-header" aria-hidden="true"></div>
    <div class="skeleton-hero" aria-hidden="true">
      <div class="skeleton-title"></div>
      <div class="skeleton-title" style="height: 24px; max-width: 400px; margin-top: 0.5rem;"></div>
    </div>
    <noscript>
      <div style="text-align: center; padding: 2rem; color: #fff;">
        <h1>TypeMasterAI - Free Typing Test</h1>
        <p>Please enable JavaScript to use this typing test application.</p>
        <p>Test your typing speed with our free online WPM calculator.</p>
      </div>
    </noscript>
  </div>
  
  <!-- Global Error Handler for Chunk Loading Errors (before React mounts) -->
  <script>
    (function() {
      var hasAttemptedRecovery = false;
      var RECOVERY_KEY = 'typemasterai_chunk_recovery';
      var RECOVERY_COOLDOWN = 10000; // 10 seconds
      
      // Check if we recently attempted recovery
      function isInRecoveryCooldown() {
        try {
          var lastRecovery = localStorage.getItem(RECOVERY_KEY);
          if (!lastRecovery) return false;
          return Date.now() - parseInt(lastRecovery, 10) < RECOVERY_COOLDOWN;
        } catch (e) { return false; }
      }
      
      function markRecoveryAttempt() {
        try { localStorage.setItem(RECOVERY_KEY, Date.now().toString()); } catch (e) {}
      }
      
      function isChunkError(error) {
        if (!error) return false;
        var msg = (error.message || '').toLowerCase();
        var name = (error.name || '').toLowerCase();
        return name === 'chunkloaderror' ||
               msg.includes('loading chunk') ||
               msg.includes('loading css chunk') ||
               msg.includes('failed to fetch dynamically imported module') ||
               msg.includes('failed to load module script') ||
               (msg.includes('failed to fetch') && msg.includes('module'));
      }
      
      async function handleChunkError() {
        if (hasAttemptedRecovery || isInRecoveryCooldown()) return;
        hasAttemptedRecovery = true;
        markRecoveryAttempt();
        
        console.log('[ChunkRecovery] Chunk loading error detected, clearing caches...');
        
        // Clear Cache API
        if ('caches' in window) {
          try {
            var names = await caches.keys();
            await Promise.all(names.map(function(n) { return caches.delete(n); }));
          } catch (e) {}
        }
        
        // Clear SW cache
        if (window.__clearServiceWorkerCache) {
          try { await window.__clearServiceWorkerCache(); } catch (e) {}
        }
        
        // Hard reload
        console.log('[ChunkRecovery] Reloading page...');
        window.location.href = window.location.href.split('?')[0] + '?_cb=' + Date.now();
      }
      
      // Global error handler
      window.addEventListener('error', function(event) {
        if (isChunkError(event.error)) {
          event.preventDefault();
          handleChunkError();
        }
      });
      
      // Unhandled promise rejections (for dynamic imports)
      window.addEventListener('unhandledrejection', function(event) {
        var error = event.reason;
        if (isChunkError(error)) {
          event.preventDefault();
          handleChunkError();
        }
      });
    })();
  </script>
  
  <script type="module" src="/src/main.tsx"></script>

  <!-- Service Worker Registration with Update Detection -->
  <script>
    (function() {
      if (!('serviceWorker' in navigator)) return;

      // Track if we're refreshing to avoid infinite loops
      var refreshing = false;
      
      // Listen for controller changes (new SW activated)
      navigator.serviceWorker.addEventListener('controllerchange', function() {
        if (refreshing) return;
        refreshing = true;
        console.log('[SW] New service worker activated, reloading...');
        window.location.reload();
      });

      window.addEventListener('load', function() {
        // First, unregister any broken service workers
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
          return Promise.all(registrations.map(function(reg) {
            return reg.unregister().catch(function() {});
          }));
        }).catch(function() {}).then(function() {
          // Small delay to ensure unregistration completes
          return new Promise(function(resolve) { setTimeout(resolve, 100); });
        }).then(function() {
          // Now register the new service worker
          return navigator.serviceWorker.register('/service-worker.js');
        }).then(function(registration) {
            console.log('[SW] Registered:', registration.scope);

            // Check for updates immediately
            registration.update();

            // Check for updates periodically (every 60 seconds)
            setInterval(function() {
              registration.update();
            }, 60000);

            // Handle waiting service worker
            function handleWaiting(worker) {
              console.log('[SW] New version waiting to activate');
              // Automatically activate the new service worker
              worker.postMessage({ type: 'SKIP_WAITING' });
            }

            // If there's already a waiting worker, handle it
            if (registration.waiting) {
              handleWaiting(registration.waiting);
            }

            // Listen for new service workers
            registration.addEventListener('updatefound', function() {
              var newWorker = registration.installing;
              if (!newWorker) return;

              console.log('[SW] Update found, installing...');

              newWorker.addEventListener('statechange', function() {
                if (newWorker.state === 'installed') {
                  if (navigator.serviceWorker.controller) {
                    // New update available
                    handleWaiting(newWorker);
                  } else {
                    // First install
                    console.log('[SW] First install complete');
                  }
                }
              });
            });
          })
          .catch(function(error) {
            console.error('[SW] Registration failed:', error);
          });
      });

      // Expose a global function to force SW update (for recovery)
      window.__forceServiceWorkerUpdate = function() {
        if (!navigator.serviceWorker.controller) return Promise.resolve();
        
        return navigator.serviceWorker.getRegistration()
          .then(function(registration) {
            if (!registration) return;
            return registration.update();
          })
          .then(function() {
            return navigator.serviceWorker.getRegistration();
          })
          .then(function(registration) {
            if (registration && registration.waiting) {
              registration.waiting.postMessage({ type: 'SKIP_WAITING' });
            }
          });
      };

      // Expose function to clear SW cache (for recovery)
      window.__clearServiceWorkerCache = function() {
        return new Promise(function(resolve) {
          if (!navigator.serviceWorker.controller) {
            resolve(false);
            return;
          }
          
          var messageChannel = new MessageChannel();
          messageChannel.port1.onmessage = function(event) {
            resolve(event.data && event.data.success);
          };
          
          navigator.serviceWorker.controller.postMessage(
            { type: 'CLEAR_CACHE' },
            [messageChannel.port2]
          );
          
          // Timeout after 5 seconds
          setTimeout(function() { resolve(false); }, 5000);
        });
      };
    })();
  </script>
</body>

</html>
